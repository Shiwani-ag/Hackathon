(window.webpackJsonp=window.webpackJsonp||[]).push([[254],{1630:function(t,e,r){"use strict";r.r(e);var n=r(10),o=r(8),l=(r(21),r(17),r(6)),c=r(1),d=r.n(c),h=r(7),y=r.n(h),v=r(330),f=r(160),O=r(2),m=r(0),j=r(5),w=r(354),S=r(358),P=r(462),T=r(161);function k(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function E(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var D=[m.A.Filters,m.A.Rating,m.A.Price,m.A.Tags],I=[m.x.Filters,m.x.Rating,m.x.Price,m.x.Tags],x=l.componentFactory.mixin(v.b).create({name:"Collection",props:{widgetIndex:d.a.ofType().default(0),site:d.a.ofType().optional,data:d.a.ofType().required,isEnabledAnimation:d.a.ofType().default(!1)},fetch(){var t=this;return Object(o.a)((function*(){t.initGridViewLayoutType(),yield t.fetchPageData()}))()},computed:{isEnabledDisplayControlsFilter(){var t;return!(null===(t=this.widgetSettings)||void 0===t||!t.topFilterEnabledSettings)&&Object.values(this.widgetSettings.topFilterEnabledSettings).some((t=>t.isEnabled))},isEnabledProductsFilters(){var{structureType:t,sidebarWidgets:e,filterWidgets:r}=this.widgetSettings;if(t==m.B.WithSidebar||t==m.B.WithFilters){if(this.isEnabledSidebar){var n=null==e?void 0:e.find((t=>t.type==m.A.Filters));return(null==n?void 0:n.isEnabled)||!1}if(this.isEnabledFilter){var o=null==r?void 0:r.find((t=>t.type==m.x.Filters));return(null==o?void 0:o.isEnabled)||!1}}return!1},isEnableProductsFiltersGroup(){var{structureType:t,sidebarWidgets:e,filterWidgets:r}=this.widgetSettings;if(t==m.B.WithSidebar||t==m.B.WithFilters){if(this.isEnabledSidebar){var n=(null==e?void 0:e.filter((t=>D.includes(t.type)&&t.isEnabled)))||[];return!(null==n||!n.length)}if(this.isEnabledFilter){var o=(null==r?void 0:r.filter((t=>I.includes(t.type)&&t.isEnabled)))||[];return!(null==o||!o.length)}}return!1}},methods:{fetchPageData(){var t=this;return Object(o.a)((function*(){try{var e;t.initQuery=Object(S.c)(t.data,null===(e=t.$route)||void 0===e?void 0:e.query);var{products:r,productGroupOptions:n}=t.data;Object(O.T)(r)?(t.isLoading=!0,yield t.fetchCollectionProducts()):t.queryResponse=r,Object(O.T)(n)?yield t.fetchProductGroupOptions():t.productGroupOptions=n}catch(t){null===j.a||void 0===j.a||j.a.errorLog({error_name:t.name,message:t.message,stack:t.stack,source_dir:"components/Builder/Site/Widgets/Store/Collection/t1/",source_file:"index.tsx"})}finally{t.isLoading=!1}}))()},fetchPage(){var t=arguments,e=this;return Object(o.a)((function*(){var r=t.length>0&&void 0!==t[0]&&t[0],n=!(t.length>1&&void 0!==t[1])||t[1];try{if(e.isLoading)return;e.isLoading=!0,yield e.fetchCollectionProducts(r,n),yield e.fetchProductGroupOptions(),yield e.setQueryToRouteParams()}catch(t){null===j.a||void 0===j.a||j.a.errorLog({error_name:t.name,message:t.message,stack:t.stack,source_dir:"components/Builder/Site/Widgets/Store/Collection/t1/",source_file:"index.tsx"})}finally{e.isLoading=!1}}))()},fetchCollectionProducts(){var t=arguments,e=this;return Object(o.a)((function*(){var r=t.length>0&&void 0!==t[0]&&t[0],n=!(t.length>1&&void 0!==t[1])||t[1];try{var o,l=Object(S.d)(null===(o=e.initQuery)||void 0===o?void 0:o.productGroupsDic),c=yield e.$api.get(new m.tb(O.g.removeEmptyFields(E(E({},e.initQuery),{},{productGroupsDic:l}))));n?e.queryResponse=c:(e.queryResponse.offset=c.offset,e.queryResponse.total=c.total,e.queryResponse.results=[...e.queryResponse.results,...c.results])}catch(t){null===j.a||void 0===j.a||j.a.errorLog({error_name:t.name,message:t.message,stack:t.stack,source_dir:"components/Builder/Site/Widgets/Store/Collection/t1/",source_file:"index.tsx"}),t.responseStatus&&"404"==t.responseStatus.errorCode&&(e.queryResponse.results=[])}finally{if(r){var d=e.$el.querySelector("#kmb-paginated-data");d&&d.scrollIntoView({behavior:"smooth"})}}}))()},fetchProductGroupOptions(){var t=this;return Object(o.a)((function*(){try{if(t.isEnableProductsFiltersGroup){var e,r,n,o,l,c=Object(S.d)(null===(e=t.initQuery)||void 0===e?void 0:e.productGroupsDic),d=new m.pb(O.g.removeEmptyFields({siteId:t.siteId,collectionId:t.data.id,includeOnlyPublished:!0,maxPrice:null===(r=t.initQuery)||void 0===r?void 0:r.maxPrice,minPrice:null===(n=t.initQuery)||void 0===n?void 0:n.minPrice,rating:null===(o=t.initQuery)||void 0===o?void 0:o.rating,tagLabels:null===(l=t.initQuery)||void 0===l?void 0:l.tagLabels,productGroupsDic:c}));t.productGroupOptions=yield t.$api.get(d)}}catch(t){null===j.a||void 0===j.a||j.a.errorLog({error_name:t.name,message:t.message,stack:t.stack,source_dir:"components/Builder/Site/Widgets/Store/Collection/t1/",source_file:"index.tsx"})}}))()},setQueryToRouteParams(){var t=this;return Object(o.a)((function*(){if(!Object(O.T)(t.initQuery)){var{minPrice:e,maxPrice:r,rating:n,tagLabels:o,productGroupsDic:l,orderBy:c,take:d}=t.initQuery,h=new S.a({rangePrices:e||r?"".concat(e,",").concat(r):null,rating:n,tagLabels:Object(O.R)(o)?null:o.join(","),q:Object(S.d)(l),orderBy:Object(O.U)(c)||c===f.a[m.Sc.Manual]?null:c,take:d});yield O.h.mergeToRoute(t.$router,t.$route,h)}}))()}},render(t){var e=this;if(this.widgetSettings)return t(T.a,{attrs:{site:this.site,settings:this.widgetSettings.styleSettings},class:"kmb-page-widget kmb-site-store-app-page-widget kmb-site-app-page-widget kmb-site-collection-widget"},[t("div",{class:y()("kmb-site-collection-widget-body",{"kmb-site-collection-widget-body-with-sidebar":this.isEnabledSidebar}),attrs:{id:"kmb-paginated-data"}},[t("div",{class:"kmb-widget-container"},[t("div",{class:"kmb-collection-top-filter-row kmb-widget-row justify-end items-center mb-8"},[this.isEnabledDisplayControlsFilter&&t("div",{class:"kmb-collection-top-filter-group-row kmb-widget-col"},[t("div",{class:"kmb-widget-row justify-end items-center"},[t(P.f,{attrs:{query:this.initQuery,widgetSettings:this.widgetSettings},on:{filter:Object(o.a)((function*(){return yield e.fetchPage(!0)}))}}),t(P.h,{attrs:{query:this.initQuery,widgetSettings:this.widgetSettings},on:{filter:Object(o.a)((function*(){return yield e.fetchPage(!0)}))}}),t(P.d,{attrs:{query:this.initQuery,widgetSettings:this.widgetSettings},on:{filter:Object(o.a)((function*(){return yield e.fetchPage(!0)}))}})])]),t(w.b,{attrs:{gridViewLayoutType:this.gridViewLayoutType,widgetSettings:this.widgetSettings,isEnabledSidebar:this.isEnabledSidebar},class:"kmb-product-grid-layout kmb-widget-col",on:{change:t=>{this.gridViewLayoutType=t}}})]),t("div",{class:y()(this.isEnabledSidebar?"kmb-widget-row":"kmb-flex")},[t(P.c,{attrs:{site:this.site,collection:this.data,widgetSettings:this.widgetSettings,isEnabled:this.isEnabledSidebar,isEnabledFilter:this.isEnabledProductsFilters,query:this.initQuery,productGroupOptions:this.productGroupOptions},on:{filter:Object(o.a)((function*(){return yield e.fetchPage(!0)}))}}),t(P.g,{attrs:{site:this.site,query:this.initQuery,queryResponse:this.queryResponse,widgetSettings:this.widgetSettings,isBottomSku:!0,isEnabledSidebar:this.isEnabledSidebar,isLoading:this.isLoading,gridViewLayoutType:this.gridViewLayoutType,isEnabledButton:!0},on:{fetch:Object(o.a)((function*(){return yield e.fetchPage(!0)})),seeMore:Object(o.a)((function*(){return yield e.fetchPage(!1,!1)}))}})])])])])}});e.default=x},303:function(t,e,r){"use strict";var n=r(2),o=[Object(n.hb)("id"),Object(n.hb)("name"),Object(n.hb)("nameHtml"),Object(n.hb)("slug"),Object(n.hb)("label"),Object(n.hb)("mainImage"),Object(n.hb)("rollOverPictureImage"),Object(n.hb)("isEnabledRollOverPicture"),Object(n.hb)("inventoryStockType"),Object(n.hb)("isAutomaticallyTrackInventory"),Object(n.hb)("availableQuantity"),Object(n.hb)("rating"),Object(n.hb)("isUsePrice"),Object(n.hb)("isUseSalePrice"),Object(n.hb)("isEnabledSku"),Object(n.hb)("isEnabledOptionGroups"),Object(n.hb)("optionGroups"),Object(n.hb)("activeInventorySku"),Object(n.hb)("defaultInventorySku"),Object(n.hb)("defaultInventorySkuId"),Object(n.hb)("skus"),Object(n.hb)("publishStatus"),Object(n.hb)("publishDate"),Object(n.hb)("siteId"),Object(n.hb)("pageTemplateType")];e.a=o},304:function(t,e,r){"use strict";var n=r(2),o=[Object(n.hb)("id"),Object(n.hb)("name"),Object(n.hb)("slug"),Object(n.hb)("image"),Object(n.hb)("pageTemplateType"),Object(n.hb)("siteId")];e.a=o},317:function(t,e,r){"use strict";r.d(e,"a",(function(){return m})),r.d(e,"b",(function(){return w}));var n=r(8),o=(r(15),r(16),r(3)),l=r(2),c=r(0),d=r(303),h=r(304),y=t=>t.filter((t=>t.id)).map((t=>t.id)),v=function(){var t=Object(n.a)((function*(t,e,r,n){try{if(r==o.e.Collections){var d=y(n);if(!Object(l.R)(d)){var v=yield t.get(new c.gb({ids:d,siteId:e,includeOnlyPublished:!0,fields:h.a.join(",")}));Object(l.R)(v.results)||n.forEach((t=>{var e,r,n=null===(e=v.results)||void 0===e?void 0:e.find((e=>e.id==t.id));n?(t.name.lczText.lczValue=n.name,t.button.page.id=n.id,t.button.page.slug=null!==(r=n.slug)&&void 0!==r?r:null,n.image&&n.image.imageUrl&&(t.image=n.image)):(t.button.page.id=null,t.button.page.slug=null)}))}}}catch(t){throw t}}));return function(e,r,n,o){return t.apply(this,arguments)}}(),f=function(){var t=Object(n.a)((function*(t,e,r,n){try{if(r==o.e.Products){var h=y(n);if(!Object(l.R)(h)){var v=yield t.get(new c.tb({ids:h,siteId:e,includeSku:!0,includeOnlyPublished:!0,fields:d.a.join(",")}));Object(l.R)(v.results)||n.forEach((t=>{var e,r=null===(e=v.results)||void 0===e?void 0:e.find((p=>p.id==t.id));if(r){var n,o,c=Object(l.s)(r);t.name.lczText.lczValue=r.name,t.price.amount=c,t.button.page.id=r.id,t.button.page.slug=null!==(n=r.slug)&&void 0!==n?n:null,t.optionsGroup=r.optionGroups,t.defaultInventorySku=r.defaultInventorySku,null!==(o=r.mainImage)&&void 0!==o&&o.imageUrl&&(t.image=r.mainImage)}else t.button.page.id=null,t.button.page.slug=null}))}}}catch(t){throw t}}));return function(e,r,n,o){return t.apply(this,arguments)}}(),O=function(){var t=Object(n.a)((function*(t,e,r,n){try{if(Object(l.R)(n))return;yield Promise.all([v(t,e,r,n),f(t,e,r,n)])}catch(t){throw t}}));return function(e,r,n,o){return t.apply(this,arguments)}}(),m=O,j=r(11),w=(t,e)=>{try{if(t&&e){e.id=t.id,Object(j.K)(e.title),e.title.lczText.lczValue=t.name;var r,n,o,image=t.coverImage;if(image&&image.imageUrl&&(e.image=image),Object(l.S)(t.shortDescription)||(Object(j.K)(e.description),e.description.lczText.lczValue=t.shortDescription),Object(l.T)(null==t?void 0:t.mainCategory))e.categoryTag.isEnabled=!1;else Object(j.K)(e.categoryTag),e.categoryTag.isEnabled=!0,e.categoryTag.lczText.lczValue=(null==t||null===(r=t.mainCategory)||void 0===r?void 0:r.name)||null;if(!Object(l.T)(null==t?void 0:t.author))Object(j.K)(e.authorName),e.authorName.isEnabled=!0,e.authorName.lczText.lczValue="".concat(null==t||null===(n=t.author)||void 0===n?void 0:n.firstName," ").concat(null==t||null===(o=t.author)||void 0===o?void 0:o.lastName);Object(l.Q)(null==t?void 0:t.expectedReadMinutes)||(Object(j.K)(e.timeToRead),e.timeToRead.lczText.lczValue=null==t?void 0:t.expectedReadMinutes),Object(j.K)(e.postDate),e.postDate.lczText.lczValue=Object(l.v)(null==t?void 0:t.publishDate,"DD.MM.YYYY"),e.button.page.id=t.id,e.button.page.slug=t.slug,e.button.page.linkType=c.cc.Blog}}catch(t){throw t}}},325:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return l.a}));var n=r(2),o=[Object(n.hb)("id"),Object(n.hb)("name"),Object(n.hb)("nameHtml"),Object(n.hb)("slug"),Object(n.hb)("coverImage"),Object(n.hb)("publishStatus"),Object(n.hb)("publishDate"),Object(n.hb)("expectedReadMinutes"),Object(n.hb)("shortDescription"),Object(n.hb)("button"),Object(n.hb)("likedCount"),Object(n.hb)("viewedCount"),Object(n.hb)("siteId"),Object(n.hb)("pageTemplateType")],l=r(303);r(304)},330:function(t,e,r){"use strict";r.d(e,"b",(function(){return h})),r.d(e,"a",(function(){return v})),r.d(e,"c",(function(){return f}));var n=r(2),o=r(3),l=r(355),c=r(0);class d{constructor(){this.queryResponse=new c.vc,this.productGroupOptions=new c.qb,this.gridViewLayoutType=o.g.Two,this.initQuery=new c.tb,this.isLoading=!1,this.isOpenTopFilter=!1}}var h={data:()=>new d,beforeDestroy(){this.queryResponse=new c.vc},computed:{siteId(){return this.$cookies.get("siteId")||this.$store.getters.getSiteId},widgetSettings(){return this.data.sortType=this.data.sortType||c.Sc.Manual,Object(n.T)(this.data.widgetSettings)&&(this.data.widgetSettings=new l.a),Object(n.T)(this.data.widgetSettings.styleSettings)&&(this.data.widgetSettings.styleSettings=new c.bc),this.data.widgetSettings},isEnabledFilter:()=>!1,isEnabledSidebar(){var{structureType:t,sidebarWidgets:e}=this.widgetSettings;return t!=c.B.Simple&&!(null==e||!e.length)}},methods:{initGridViewLayoutType(){try{var t=this.$cookies.get("grid_display");t&&o.g[t]?this.gridViewLayoutType=t:this.gridViewLayoutType=this.isEnabledSidebar?o.g.Three:o.g.Four}catch(t){console.log(t)}}}},y=(r(317),r(11)),v={created(){var t,e,r,o,l,c,d,h,v,f;this.data&&(Object(y.K)(null===(t=this.settings)||void 0===t?void 0:t.title),Object(y.K)(null===(e=this.settings)||void 0===e?void 0:e.description),this.data.name=(null===(r=this.data)||void 0===r?void 0:r.name)||(null===(o=this.settings.title.lczText)||void 0===o?void 0:o.lczValue),this.data.nameHtml=(null===(l=this.data)||void 0===l?void 0:l.nameHtml)||(null===(c=this.settings.title.lczText)||void 0===c?void 0:c.lczValue),this.data.shortDescription=(null===(d=this.data)||void 0===d?void 0:d.shortDescription)||(null===(h=this.settings.description)||void 0===h||null===(v=h.lczText)||void 0===v?void 0:v.lczValue),null!==(f=this.data)&&void 0!==f&&f.publishDate&&(this.data.publishDate=Object(n.v)(this.data.publishDate)))},computed:{siteId(){return this.$cookies.get("siteId")||this.$store.getters.getSiteId},currentPage(){return this.$store.getters.getPage}}},f={created(){var t,e;null!==(t=this.settings)&&void 0!==t&&null!==(e=t.tabs)&&void 0!==e&&e.items&&this.settings.tabs.items.forEach((t=>{t.tabItems&&t.tabItems.forEach((t=>{Object(y.K)(t.question)}))}))}}},358:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"c",(function(){return m})),r.d(e,"d",(function(){return j})),r.d(e,"b",(function(){return w}));r(17);var n=r(8),o=r(10),l=(r(24),r(325)),c=r(0),d=r(2),h=r(160);function y(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}class f{constructor(t){this.rangePrices=null,this.rating=null,this.tagLabels=null,this.q=null,this.orderBy=null,this.take=null,Object.assign(this,t)}}var O=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c.tb,r=arguments.length>1?arguments[1]:void 0;if(Object(d.T)(r))return e;if(null!=r&&r.rangePrices){var n,o=null===(n=String(r.rangePrices))||void 0===n?void 0:n.split(",").map((t=>Number(t)));e.minPrice=o[0],e.maxPrice=o[1]}(Object(d.Z)(null==r?void 0:r.rating)&&(e.rating=Number(r.rating)),null!=r&&r.tagLabels)&&(e.tagLabels=null===(t=String(r.tagLabels))||void 0===t?void 0:t.split(","));if(null!=r&&r.q){var l=JSON.parse(String(null==r?void 0:r.q));Object(d.T)(l)||(e instanceof c.tb?e.productGroupsDic=l:e instanceof c.gb&&(e.filterProductGroupsDic=l))}return d.g.removeEmptyFields(v({},e))},m=(t,e)=>{if(Object(d.T)(t))return new c.tb;var r=Object(d.mb)(new c.tb({siteId:t.siteId,includeSku:!0,includeOnlyPublished:!0,include:"total",take:12,skip:0,collectionId:t.id,orderBy:h.a[null==t?void 0:t.sortType]||"-id",fields:l.b.join(",")}),e);return t.includeAllProducts||(r.collectionId=t.id),O(new c.tb(v({},r)),e)},j=t=>Object(d.T)(t)?null:JSON.stringify(t),w=function(){var t=Object(n.a)((function*(t,e,r){try{var n=((t,e)=>{if(!Object(d.T)(t)){var r=new c.gb(v({includeSidebarContent:!0,includeOnlyPublished:!0},t));return O(r,e)}})(e,r),o=j(null==n?void 0:n.filterProductGroupsDic),l=yield t.getSingle(new c.gb(d.g.removeEmptyFields(v(v({},n),{},{filterProductGroupsDic:o}))));if(!l)return null;var h=m(l,r),y=j(null==h?void 0:h.productGroupsDic);if(!Object(d.T)(h)){var f=yield t.get(new c.tb(d.g.removeEmptyFields(v(v({},h),{},{productGroupsDic:y}))));Object(d.T)(f)||(l.products=f)}return l}catch(t){throw t}}));return function(e,r,n){return t.apply(this,arguments)}}()}}]);